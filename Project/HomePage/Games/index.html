<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Gamified Learning Platform — Rich Prototype</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --bg:#eef2ff; --card:#ffffff; --accent:#4f46e5; --muted:#6b7280;
      --success:#10b981; --danger:#ef4444;
    }
    *{box-sizing:border-box;font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;}
    body{margin:0;background:linear-gradient(180deg,#f7f9ff,var(--bg));min-height:100vh;padding:18px}
    header{display:flex;align-items:center;gap:12px;margin-bottom:16px}
    .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#06b6d4);display:flex;align-items:center;justify-content:center;color:white;font-weight:800}
    h1{margin:0;font-size:18px}
    .layout{display:grid;grid-template-columns:260px 1fr;gap:16px}
    .panel{background:var(--card);padding:14px;border-radius:12px;box-shadow:0 8px 26px rgba(15,23,42,0.06)}
    .sidebar .section{margin-bottom:12px}
    button{cursor:pointer;border:0;border-radius:8px;padding:8px 10px}
    .game-btn{display:block;width:100%;text-align:left;margin-bottom:8px;padding:10px;background:linear-gradient(180deg,#fff,#f6f9ff);border:1px solid rgba(0,0,0,0.04)}
    .btn-primary{background:var(--accent);color:white}
    .btn-ghost{background:transparent;border:1px solid #e6eefc}
    .small{font-size:13px;color:var(--muted)}
    .big{font-weight:700;font-size:20px}
    .game-area{min-height:420px;padding:6px}
    .question{font-size:20px;margin:12px 0}
    .option{padding:10px;border-radius:8px;border:1px solid #e6eefc; margin:8px 0; cursor:pointer;background:white}
    .option:hover{background:#f6f8ff}
    input.answer-box{padding:12px;font-size:18px;width:320px;border-radius:10px;border:1px solid #d1d5db}
    .score-row{display:flex;gap:12px;align-items:center;margin-bottom:8px}
    .badge{display:inline-block;padding:6px 10px;border-radius:999px;background:linear-gradient(90deg,#fff7ed,#ffedd5);font-weight:700;margin-right:6px}
    .refresh{background:#16a34a;color:white;padding:10px;border-radius:8px;border:0}
    .flex{display:flex;gap:8px;align-items:center}
    .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media(max-width:900px){.layout{grid-template-columns:1fr;}.sidebar{order:2}}
  </style>
</head>
<body>
  <header>
    <div class="logo">GL</div>
    <div>
      <h1>Gamified Learning — Grades 1–8</h1>
      <div class="small">Rich content, multiple games, adaptive difficulty</div>
    </div>
    <div style="margin-left:auto" class="flex">
      <label class="small">Grade</label>
      <select id="gradeSelect">
        <option value="1">Grade 1</option><option value="2">Grade 2</option><option value="3">Grade 3</option>
        <option value="4">Grade 4</option><option value="5">Grade 5</option><option value="6">Grade 6</option>
        <option value="7">Grade 7</option><option value="8">Grade 8</option>
      </select>
      <button id="resetAll" title="Reset local progress" class="btn-ghost">Reset Progress</button>
    </div>
  </header>

  <div class="layout">
    <aside class="panel sidebar">
      <div class="section">
        <div class="small">Player</div>
        <div id="playerName" class="big">Guest • Grade 1</div>
      </div>

      <div class="section">
        <div class="small">Available Games</div>
        <div id="gameList" style="margin-top:8px"></div>
      </div>

      <div class="section">
        <div class="small">Points</div>
        <div id="points" class="big">0</div>
        <div class="small" style="margin-top:8px">Badges</div>
        <div id="badges" style="margin-top:6px"></div>
      </div>

      <div class="section small" style="margin-top:12px;color:var(--muted)">
        Tip: Change grade to see different games and difficulty. Use Refresh after finishing a grade game.
      </div>
    </aside>

    <main class="panel main">
      <div class="score-row">
        <div class="small">Current Game:</div>
        <div id="currentGame" class="big">Select a game</div>
        <div style="margin-left:auto" class="small">Coins: <span id="coins">0</span></div>
      </div>

      <div id="gameArea" class="game-area">
        <div class="small">Choose a game from the left. This prototype contains many randomized questions per grade.</div>
      </div>
    </main>
  </div>

<script>
/* ---------- Persistence ---------- */
const STORAGE_KEY = 'gl_rich_v1';
let state = loadState();
function loadState(){
  try{
    const s = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
    return Object.assign({points:0,coins:0,badges:[],history:[]}, s);
  }catch(e){ return {points:0,coins:0,badges:[],history:[]}; }
}
function saveState(){
  state.coins = Math.floor(state.points / 50);
  localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
  updateUI();
}
function addPoints(pts,game){
  state.points += pts;
  state.history = state.history || [];
  state.history.unshift({game,points:pts,ts:Date.now()});
  if(state.history.length>100) state.history.pop();
  saveState();
}
function addBadge(b){
  if(!state.badges.includes(b)){ state.badges.push(b); saveState(); }
}
function resetProgress(){
  if(confirm('Reset local progress?')){
    state = {points:0,coins:0,badges:[],history:[]};
    saveState();
    location.reload();
  }
}

/* ---------- UI ---------- */
const gradeSelect = document.getElementById('gradeSelect');
const gameListEl = document.getElementById('gameList');
const playerNameEl = document.getElementById('playerName');
const pointsEl = document.getElementById('points');
const badgesEl = document.getElementById('badges');
const currentGameEl = document.getElementById('currentGame');
const coinsEl = document.getElementById('coins');
const gameArea = document.getElementById('gameArea');
document.getElementById('resetAll').onclick = resetProgress;

function updateUI(){
  pointsEl.textContent = state.points;
  coinsEl.textContent = state.coins;
  badgesEl.innerHTML = state.badges.map(b=>`<span class="badge">${b}</span>`).join(' ');
  playerNameEl.textContent = `Guest • Grade ${getGrade()}`;
}
updateUI();

/* ---------- Grade & available games logic ---------- */
function getGrade(){ return parseInt(gradeSelect.value,10); }
gradeSelect.onchange = () => { updateUI(); renderGameList(); showHome(); };

function renderGameList(){
  const g = getGrade();
  // Define which games available by grade
  const mapping = [
    {id:'math',label:'Math Challenge',min:1},
    {id:'spelling',label:'Spelling (Scramble / Hangman)',min:1},
    {id:'science',label:'Science Quiz',min:1},
    {id:'social',label:'Social Studies Quiz',min:1},
    {id:'fasttap',label:'Fast Tap (speed quiz)',min:4, max:6},
    {id:'truefalse',label:'True/False Lightning',min:6, max:8},
    
  ];
  gameListEl.innerHTML = '';
  mapping.forEach(m=>{
    if( (g>= (m.min||1)) && (m.max? g<=m.max:true) ){
      const btn = document.createElement('button');
      btn.className='game-btn';
      btn.textContent = m.label;
      btn.onclick = ()=>{ currentGameEl.textContent = m.label; routeGame(m.id); };
      gameListEl.appendChild(btn);
    }
  });
}
renderGameList();

/* ---------- Helpers & UI utilities ---------- */
function clearArea(){ gameArea.innerHTML = ''; }
function addRefreshButton(){
  const btn = document.createElement('button');
  btn.className = 'refresh';
  btn.textContent = '🔄 Refresh Page';
  btn.onclick = ()=> location.reload();
  gameArea.appendChild(document.createElement('hr'));
  gameArea.appendChild(btn);
}

/* ---------- Random utilities ---------- */
function randInt(a,b){ return Math.floor(Math.random()*(b-a+1))+a; }
function shuffle(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]];} return arr; }

/* ---------- Math Generator (10-15 problems by grade) ---------- */
function generateMathProblems(grade){
  const n = grade<=2?8:grade<=4?10:grade<=6?12:15;
  const list = [];
  for(let i=0;i<n;i++){
    if(grade<=2){
      const a=randInt(1,20), b=randInt(1,20);
      list.push({expr:`${a} + ${b}`, ans: a+b});
    } else if(grade<=4){
      const a=randInt(5,50), b=randInt(2,12);
      const ops=['+','-','*']; const op=ops[randInt(0,2)];
      list.push({expr:`${a} ${op} ${b}`, ans: Math.floor(eval(`${a}${op}${b}`))});
    } else if(grade<=6){
      const type=randInt(1,4);
      if(type<=2){
        const a=randInt(10,120), b=randInt(2,12), op = ['+','-','*'][randInt(0,2)];
        list.push({expr:`${a} ${op} ${b}`, ans: Math.floor(eval(`${a}${op}${b}`))});
      } else {
        // Division with integer result
        const b=randInt(2,12), q=randInt(2,12);
        const a=b*q;
        list.push({expr:`${a} ÷ ${b}`, ans: q});
      }
    } else {
      // grade 7-8: include squares, roots, parentheses, mixed
      const type=randInt(1,5);
      if(type===1){
        const a=randInt(6,20); list.push({expr:`${a}²`, ans: a*a});
      } else if(type===2){
        const a=randInt(6,20); list.push({expr:`√${a*a}`, ans: a});
      } else if(type===3){
        const a=randInt(10,50), b=randInt(2,10), c=randInt(2,8);
        list.push({expr:`(${a} + ${b}) × ${c}`, ans: (a+b)*c});
      } else if(type===4){
        const a=randInt(2,12), b=randInt(2,12);
        list.push({expr:`${a*b} ÷ ${b}`, ans: a});
      } else {
        const a=randInt(2,15), b=randInt(2,15);
        list.push({expr:`${a} × ${b}`, ans: a*b});
      }
    }
  }
  return list;
}

/* ---------- Math Challenge (input answers, scoreboard) ---------- */
function renderMath(){
  clearArea();
  const grade = getGrade();
  const problems = generateMathProblems(grade);
  let idx = 0, score=0;
  const header = document.createElement('div');
  header.innerHTML = `<div class="small">Grade ${grade} • Math — ${problems.length} questions</div>`;
  gameArea.appendChild(header);

  const qbox = document.createElement('div'); qbox.style.marginTop='12px';
  gameArea.appendChild(qbox);

  function showQ(){
    if(idx>=problems.length){
      gameArea.innerHTML = `<h2>Math Complete 🎉</h2><p class="small">You scored ${score} / ${problems.length*10}</p>`;
      addPoints(score,'Math'); if(score >= problems.length*8) addBadge('Math Pro');
      addRefreshButton(); return;
    }
    const p = problems[idx];
    qbox.innerHTML = `<div class="question">${p.expr}</div>
      <input id="mathAns" class="answer-box" autocomplete="off" />
      <div style="margin-top:8px"><button id="submitMath" class="btn-primary">Submit</button> <span style="margin-left:10px" class="small">Question ${idx+1}/${problems.length}</span></div>
      <div id="mathMsg" class="small" style="margin-top:8px"></div>
      <div class="small" style="margin-top:8px">Score: ${score}</div>`;
    const inp = document.getElementById('mathAns');
    inp.focus();
    document.getElementById('submitMath').onclick = ()=>{
      const val = Number(inp.value);
      const msg = document.getElementById('mathMsg');
      if(!isNaN(val) && val === p.ans){
        score += 10;
        msg.textContent = '✅ Correct +10';
        msg.style.color = 'var(--success)';
      } else {
        msg.textContent = `❌ Wrong — Correct: ${p.ans}`;
        msg.style.color = 'var(--danger)';
      }
      idx++;
      setTimeout(showQ,900);
    };
  }
  showQ();
}

/* ---------- Spelling: scramble for low grades; hangman for high grades ---------- */
const spellingPool = {
  1:['cat','dog','sun','ball','red','tree','bird','milk','book','cup'],
  2:['apple','river','house','green','water','garden','family','table','chair','smile'],
  3:['school','friend','teacher','window','pencil','garden','animal','planet','flower','planet'],
  4:['because','beautiful','mountain','animal','weather','country','capital','history','science','picture'],
  5:['adventure','science','history','language','between','economy','culture','society','climate','gravity'],
  6:['community','education','memory','electric','absolute','biology','chemistry','physics','function','theory'],
  7:['architecture','philosophy','biography','structure','currency','democracy','constitution','republic','election','industry'],
  8:['hypothesis','photosynthesis','constitution','literature','civilization','independence','parliament','legislation','industrial','agriculture']
};

function renderSpelling(){
  clearArea();
  const grade = getGrade();
  const words = shuffle([...spellingPool[grade] || spellingPool[1]]);
  // grade <=4 scramble mode; >=5 hangman-style
  if(grade <= 4){
    let idx=0,score=0;
    const header = document.createElement('div');
    header.innerHTML = `<div class="small">Grade ${grade} • Scramble Spelling (${words.length} words)</div>`;
    gameArea.appendChild(header);
    const box = document.createElement('div'); box.style.marginTop='12px'; gameArea.appendChild(box);
    function show(){
      if(idx>=words.length){
        gameArea.innerHTML = `<h2>Spelling Complete 🎉</h2><p class="small">Score: ${score}</p>`;
        addPoints(score,'Spelling'); if(score>=words.length*8) addBadge('Spelling Ace'); addRefreshButton(); return;
      }
      const w = words[idx];
      const scrambled = shuffle(w.split('')).join('');
      box.innerHTML = `<div class="question">Unscramble: <strong>${scrambled}</strong></div>
        <input id="spellIn" class="answer-box" autocomplete="off" />
        <div style="margin-top:8px"><button id="spellSubmit" class="btn-primary">Submit</button> <button id="spellSkip" class="btn-ghost">Skip</button></div>
        <div id="spellMsg" class="small" style="margin-top:8px"></div>
        <div class="small" style="margin-top:8px">Score: ${score}</div>`;
      document.getElementById('spellSubmit').onclick = ()=>{
        const val = document.getElementById('spellIn').value.trim().toLowerCase();
        if(val === w){ score += 10; document.getElementById('spellMsg').textContent = '✅ Correct +10'; }
        else { document.getElementById('spellMsg').textContent = `❌ Wrong — ${w}`; }
        idx++; setTimeout(show,900);
      };
      document.getElementById('spellSkip').onclick = ()=>{ idx++; show(); };
      document.getElementById('spellIn').focus();
    }
    show();
  } else {
    // Hangman-ish: show blanks, allow guesses (simplified)
    let idx=0,score=0;
    const header = document.createElement('div');
    header.innerHTML = `<div class="small">Grade ${grade} • Hangman-style Spelling (${words.length} words)</div>`;
    gameArea.appendChild(header);
    const box = document.createElement('div'); box.style.marginTop='12px'; gameArea.appendChild(box);
    function show(){
      if(idx>=words.length){
        gameArea.innerHTML = `<h2>Spelling Complete 🎉</h2><p class="small">Score: ${score}</p>`;
        addPoints(score,'Spelling'); if(score>=words.length*8) addBadge('Spelling Ace'); addRefreshButton(); return;
      }
      const w = words[idx];
      let guessed = new Set();
      let attempts = Math.max(6, Math.floor(w.length*1.2));
      function renderState(){
        const display = w.split('').map(ch => guessed.has(ch) ? ch : '_').join(' ');
        box.innerHTML = `<div class="question">${display}</div>
          <div class="small">Attempts left: ${attempts}</div>
          <input id="letter" maxlength="1" class="answer-box" style="width:80px;margin-top:8px" />
          <div style="margin-top:8px">
            <button id="guess" class="btn-primary">Guess Letter</button>
            <button id="solve" class="btn-ghost">Solve Word</button>
          </div>
          <div id="hangMsg" class="small" style="margin-top:8px"></div>
          <div class="small" style="margin-top:8px">Score: ${score}</div>`;
        document.getElementById('guess').onclick = ()=>{
          const l = document.getElementById('letter').value.trim().toLowerCase();
          if(!l) return;
          document.getElementById('letter').value = '';
          if(w.includes(l)){ guessed.add(l); document.getElementById('hangMsg').textContent = 'Good!'; }
          else { attempts--; document.getElementById('hangMsg').textContent = 'Wrong!'; }
          if(w.split('').every(ch=>guessed.has(ch))){
            score += 15; idx++; setTimeout(show,700);
            return;
          }
          if(attempts<=0){ document.getElementById('hangMsg').textContent = `Out of attempts. Word: ${w}`; idx++; setTimeout(show,900); return; }
          renderState();
        };
        document.getElementById('solve').onclick = ()=>{
          const sol = prompt('Type the full word:').trim().toLowerCase();
          if(sol===w){ score+=20; document.getElementById('hangMsg').textContent='Correct!'; idx++; setTimeout(show,700); return;}
          else { attempts -= 2; document.getElementById('hangMsg').textContent='Wrong solution'; if(attempts<=0){ idx++; setTimeout(show,900); return;} renderState(); }
        };
        document.getElementById('letter').focus();
      }
      renderState();
    }
    show();
  }
}

/* ---------- Science & Social Pools (many questions per grade) ---------- */
const sciencePool = {
  1:[
    {q:'Which shines in the sky during daytime?', opts:['Sun','Moon','Star'], ans:'Sun'},
    {q:'Which animal lives in water?', opts:['Cow','Fish','Bird'], ans:'Fish'},
    {q:'Which helps us see at night?', opts:['Ear','Eye','Nose'], ans:'Eye'},
    {q:'What do plants need to grow?', opts:['Soil & water','Chocolate','Shoes'], ans:'Soil & water'},
    {q:'Which is a big body of water?', opts:['Lake','Mountain','House'], ans:'Lake'},
    {q:'Which has wings and can fly?', opts:['Frog','Bird','Lion'], ans:'Bird'}
  ],
  2:[
    {q:'Which is a source of light?', opts:['Sun','Tree','Rock'], ans:'Sun'},
    {q:'Which organ pumps blood?', opts:['Liver','Heart','Skin'], ans:'Heart'},
    {q:'Where do fish live?', opts:['Sky','Water','Desert'], ans:'Water'},
    {q:'Which is a fruit?', opts:['Carrot','Apple','Potato'], ans:'Apple'},
    {q:'What do bees make?', opts:['Honey','Milk','Bread'], ans:'Honey'}
  ],
  3:[
    {q:'Which system helps you move?', opts:['Circulatory','Muscular','Digestive'], ans:'Muscular'},
    {q:'What gas do plants release?', opts:['Oxygen','Carbon dioxide','Nitrogen'], ans:'Oxygen'},
    {q:'Which planet is known as Red Planet?', opts:['Earth','Mars','Venus'], ans:'Mars'},
    {q:'Which part of plant makes food?', opts:['Roots','Leaves','Stems'], ans:'Leaves'},
    {q:'What is the boiling point of water (°C)?', opts:['100','50','0'], ans:'100'}
  ],
  4:[
    {q:'Which instrument is used to view tiny things?', opts:['Telescope','Microscope','Thermometer'], ans:'Microscope'},
    {q:'What force pulls objects to Earth?', opts:['Friction','Gravity','Magnetism'], ans:'Gravity'},
    {q:'What is evaporation?', opts:['Liquid to gas','Gas to liquid','Solid to liquid'], ans:'Liquid to gas'},
    {q:'What is the centre of an atom?', opts:['Nucleus','Electron','Proton'], ans:'Nucleus'},
    {q:'Which organ digests food?', opts:['Lungs','Stomach','Heart'], ans:'Stomach'}
  ],
  5:[
    {q:'What do we call Earth’s natural satellite?', opts:['Moon','Sun','Mars'], ans:'Moon'},
    {q:'What does a thermometer measure?', opts:['Temperature','Distance','Mass'], ans:'Temperature'},
    {q:'Which is a renewable source of energy?', opts:['Coal','Oil','Solar'], ans:'Solar'},
    {q:'Which gas do humans breathe out?', opts:['Oxygen','Carbon dioxide','Nitrogen'], ans:'Carbon dioxide'},
    {q:'Which part of plant absorbs water?', opts:['Leaves','Roots','Stem'], ans:'Roots'}
  ],
  6:[
    {q:'Which organelle is the powerhouse of cell?', opts:['Nucleus','Mitochondria','Ribosome'], ans:'Mitochondria'},
    {q:'Which process produces new plants from seeds?', opts:['Germination','Condensation','Evaporation'], ans:'Germination'},
    {q:'What is photosynthesis?', opts:['Process making food in plants','Process of breathing','Process of drinking'], ans:'Process making food in plants'},
    {q:'Electric current unit?', opts:['Volt','Ampere','Ohm'], ans:'Ampere'},
    {q:'What is pH less than 7?', opts:['Neutral','Acidic','Basic'], ans:'Acidic'}
  ],
  7:[
    {q:'Which particle has positive charge?', opts:['Electron','Proton','Neutron'], ans:'Proton'},
    {q:'Which law relates to inertia?', opts:['Newton\'s 1st','Newton\'s 2nd','Ohm\'s law'], ans:"Newton's 1st"},
    {q:'Which organ filters blood?', opts:['Kidney','Liver','Pancreas'], ans:'Kidney'},
    {q:'What is the main gas in Earth’s atmosphere?', opts:['Oxygen','Nitrogen','Carbon dioxide'], ans:'Nitrogen'},
    {q:'Which branch studies plants?', opts:['Zoology','Botany','Geology'], ans:'Botany'}
  ],
  8:[
    {q:'What is an isotope?', opts:['Atoms with same protons different neutrons','Molecules with bonds','Ionized atoms'], ans:'Atoms with same protons different neutrons'},
    {q:'Which process converts solid directly to gas?', opts:['Sublimation','Evaporation','Condensation'], ans:'Sublimation'},
    {q:'Which organ produces bile?', opts:['Liver','Stomach','Gallbladder'], ans:'Liver'},
    {q:'Which is example of physical change?', opts:['Burning wood','Melting ice','Rusting'], ans:'Melting ice'},
    {q:'Which law states action = -reaction?', opts:['Newton 1','Newton 2','Newton 3'], ans:'Newton 3'}
  ]
};

const socialPool = {
  1:[
    {q:'National bird of India?', opts:['Peacock','Sparrow','Crow'], ans:'Peacock'},
    {q:'Which is a big building where books are kept?', opts:['Library','Hospital','Market'], ans:'Library'},
    {q:'Which means "home"?', opts:['School','House','Park'], ans:'House'},
    {q:'We celebrate birthday when we turn?', opts:['Older','Younger','Same'], ans:'Older'},
    {q:'Which vehicle travels on rails?', opts:['Bus','Train','Car'], ans:'Train'}
  ],
  2:[
    {q:'Capital of India?', opts:['Delhi','Mumbai','Chennai'], ans:'Delhi'},
    {q:'Which festival is lights festival?', opts:['Holi','Diwali','Pongal'], ans:'Diwali'},
    {q:'Our country is called?', opts:['India','China','USA'], ans:'India'},
    {q:'Which animal is national animal of India?', opts:['Tiger','Cow','Lion'], ans:'Tiger'},
    {q:'What do we call the head of a family?', opts:['Father','Mother','Leader'], ans:'Father'}
  ],
  3:[
    {q:'Where is Taj Mahal located?', opts:['Agra','Delhi','Jaipur'], ans:'Agra'},
    {q:'Which state has Konark Sun Temple?', opts:['Odisha','Gujrat','Punjab'], ans:'Odisha'},
    {q:'Which is India’s currency?', opts:['Dollar','Rupee','Euro'], ans:'Rupee'},
    {q:'Which sea is to the west of India?', opts:['Bay of Bengal','Arabian Sea','Laccadive Sea'], ans:'Arabian Sea'},
    {q:'Which festival celebrates colours?', opts:['Holi','Diwali','Eid'], ans:'Holi'}
  ],
  4:[
    {q:'Who was the first Prime Minister of India?', opts:['Nehru','Gandhi','Patel'], ans:'Nehru'},
    {q:'Which is pink city?', opts:['Jaipur','Kolkata','Hyderabad'], ans:'Jaipur'},
    {q:'Which mountain is highest in India?', opts:['K2','Kangchenjunga','Mount Everest'], ans:'Kangchenjunga'},
    {q:'Which is a major river in India?', opts:['Ganga','Thames','Nile'], ans:'Ganga'},
    {q:'Which is national flower of India?', opts:['Lotus','Rose','Lily'], ans:'Lotus'}
  ],
  5:[
    {q:'Where is India Gate?', opts:['Delhi','Kolkata','Mumbai'], ans:'Delhi'},
    {q:'Which state is known for tea gardens?', opts:['Assam','Rajasthan','Gujarat'], ans:'Assam'},
    {q:'Which is capital of Tamil Nadu?', opts:['Chennai','Coimbatore','Madurai'], ans:'Chennai'},
    {q:'Which movement helped India gain independence?', opts:['Salt March','Industrial','Space'], ans:'Salt March'},
    {q:'Which body writes laws?', opts:['Parliament','Court','Army'], ans:'Parliament'}
  ],
  6:[
    {q:'Who is called Father of Indian Constitution?', opts:['Ambedkar','Nehru','Gandhi'], ans:'Ambedkar'},
    {q:'Which is highest civil service exam?', opts:['IAS','GATE','JEE'], ans:'IAS'},
    {q:'Which is India’s national emblem?', opts:['Ashoka Chakra','Lion Capital','Map'], ans:'Lion Capital'},
    {q:'In which year did India gain independence?', opts:['1947','1950','1930'], ans:'1947'},
    {q:'Which is lower house of Parliament?', opts:['Lok Sabha','Rajya Sabha','Assembly'], ans:'Lok Sabha'}
  ],
  7:[
    {q:'When was the Indian Constitution adopted?', opts:['1949','1950','1947'], ans:'1950'},
    {q:'Who led the Non-Cooperation Movement?', opts:['Gandhi','Nehru','Tilak'], ans:'Gandhi'},
    {q:'Which system has three branches?', opts:['Federal','Unitary','Confederal'], ans:'Federal'},
    {q:'What is secularism?', opts:['Single religion','No religion','Equal respect for all religions'], ans:'Equal respect for all religions'},
    {q:'What is the fundamental duty?', opts:['Duty to vote','Protect environment','None of these'], ans:'Protect environment'}
  ],
  8:[
    {q:'Who discovered the sea route to India?', opts:['Vasco da Gama','Columbus','Magellan'], ans:'Vasco da Gama'},
    {q:'When did India become a Republic?', opts:['1947','1950','1952'], ans:'1950'},
    {q:'What is the function of Supreme Court?', opts:['Legislate','Interpret law','Execute law'], ans:'Interpret law'},
    {q:'What is GDP?', opts:['Total goods & services value','Population','Area'], ans:'Total goods & services value'},
    {q:'What is federalism?', opts:['One central power','Division of powers between centre and states','State only'], ans:'Division of powers between centre and states'}
  ]
};

/* ---------- Science Quiz (MCQ list) ---------- */
function renderScience(){
  clearArea();
  const grade = getGrade();
  const pool = shuffle([...(sciencePool[grade]||sciencePool[1])]);
  let idx=0, score=0;
  const header = document.createElement('div'); header.innerHTML = `<div class="small">Grade ${grade} • Science Quiz (${pool.length} Qs)</div>`;
  gameArea.appendChild(header);
  const box = document.createElement('div'); box.style.marginTop='12px'; gameArea.appendChild(box);

  function show(){
    if(idx>=pool.length){
      gameArea.innerHTML = `<h2>Science Complete 🎉</h2><p class="small">Score: ${score}</p>`; addPoints(score,'Science'); if(score>=pool.length*8) addBadge('Science Star'); addRefreshButton(); return;
    }
    const q = pool[idx];
    box.innerHTML = `<div class="question">${q.q}</div><div class="small">Score: ${score}</div>`;
    const opts = shuffle([...q.opts]);
    opts.forEach(opt=>{
      const d = document.createElement('div'); d.className='option'; d.textContent=opt;
      d.onclick = ()=>{
        if(opt===q.ans){ score+=10; d.style.background='lightgreen'; } else { d.style.background='#ffb3b3'; }
        idx++; setTimeout(show,700);
      };
      box.appendChild(d);
    });
  }
  show();
}

/* ---------- Social Studies Quiz ---------- */
function renderSocial(){
  clearArea();
  const grade = getGrade();
  const pool = shuffle([...(socialPool[grade]||socialPool[1])]);
  let idx=0,score=0;
  const header = document.createElement('div'); header.innerHTML = `<div class="small">Grade ${grade} • Social Studies (${pool.length} Qs)</div>`;
  gameArea.appendChild(header);
  const box = document.createElement('div'); box.style.marginTop='12px'; gameArea.appendChild(box);
  function show(){
    if(idx>=pool.length){
      gameArea.innerHTML = `<h2>Social Studies Complete 🎉</h2><p class="small">Score: ${score}</p>`; addPoints(score,'Social'); if(score>=pool.length*8) addBadge('Social Star'); addRefreshButton(); return;
    }
    const q = pool[idx];
    box.innerHTML = `<div class="question">${q.q}</div><div class="small">Score: ${score}</div>`;
    shuffle(q.opts).forEach(opt=>{
      const d = document.createElement('div'); d.className='option'; d.textContent=opt;
      d.onclick = ()=>{ if(opt===q.ans){score+=10; d.style.background='lightgreen';} else d.style.background='#ffb3b3'; idx++; setTimeout(show,700); };
      box.appendChild(d);
    });
  }
  show();
}

/* ---------- Fast Tap (speedy MCQ) ---------- */
function renderFastTap(){
  clearArea();
  const grade = getGrade();
  // combine science+social into quick pool
  const pool = shuffle([...(sciencePool[grade]||sciencePool[1]), ...(socialPool[grade]||socialPool[1])]).slice(0,10);
  let idx=0,score=0,timePerQ = 4000; // ms
  gameArea.innerHTML = `<div class="small">Fast Tap — answer quickly! Grade ${grade}</div><div id="fastBox" style="margin-top:12px"></div><div id="fastScore" class="small" style="margin-top:8px">Score: ${score}</div>`;
  const fastBox = document.getElementById('fastBox');
  function next(){
    if(idx>=pool.length){ gameArea.innerHTML = `<h2>Fast Tap Complete 🎉</h2><p class="small">Score: ${score}</p>`; addPoints(score,'FastTap'); addRefreshButton(); return; }
    const q = pool[idx];
    fastBox.innerHTML = `<div class="question">${q.q}</div>`;
    const opts = shuffle([...q.opts]);
    let timedOut = false;
    const timer = setTimeout(()=>{ timedOut = true; idx++; next(); }, timePerQ);
    opts.forEach(opt=>{
      const d = document.createElement('div'); d.className='option'; d.textContent = opt;
      d.onclick = ()=>{
        if(timedOut) return;
        clearTimeout(timer);
        if(opt===q.ans){ score+=12; d.style.background='lightgreen'; } else { d.style.background='#ffb3b3'; }
        idx++; setTimeout(next,400);
      };
      fastBox.appendChild(d);
    });
    document.getElementById('fastScore').textContent = `Score: ${score}`;
  }
  next();
}

/* ---------- True/False Lightning (grade 6-8) ---------- */
const tfPool = [
  {q:'The earth revolves around the sun.', t:true},
  {q:'Water boils at 50°C.', t:false},
  {q:'Photosynthesis occurs in leaves.', t:true},
  {q:'The Great Wall is in India.', t:false},
  {q:'Sound travels faster than light.', t:false},
  {q:'India became independent in 1947.', t:true},
  {q:'Mitochondria produce energy in cells.', t:true},
  {q:'Gravity is stronger on the moon than Earth.', t:false}
];
function renderTrueFalse(){
  clearArea();
  const grade = getGrade();
  const pool = shuffle(tfPool).slice(0,8);
  let idx=0,score=0, timePer=3000;
  gameArea.innerHTML = `<div class="small">True/False Lightning — Grade ${grade}</div><div id="tfBox" style="margin-top:12px"></div><div id="tfScore" class="small" style="margin-top:8px">Score: ${score}</div>`;
  function next(){
    if(idx>=pool.length){ gameArea.innerHTML = `<h2>Lightning Complete 🎉</h2><p class="small">Score: ${score}</p>`; addPoints(score,'TrueFalse'); addRefreshButton(); return;}
    const q=pool[idx];
    const box = document.getElementById('tfBox'); box.innerHTML = `<div class="question">${q.q}</div><div style="display:flex;gap:10px"><button id="tBtn" class="btn-primary">True</button><button id="fBtn" class="btn-ghost">False</button></div>`;
    let timed = setTimeout(()=>{ idx++; next(); }, timePer);
    document.getElementById('tBtn').onclick = ()=>{
      clearTimeout(timed); if(q.t) score+=10; idx++; next();
    };
    document.getElementById('fBtn').onclick = ()=>{
      clearTimeout(timed); if(!q.t) score+=10; idx++; next();
    };
    document.getElementById('tfScore').textContent = `Score: ${score}`;
  }
  next();
}

/* ---------- Hangman (hard words) - grade 6-8 alternative ---------- */

/* ---------- Router ---------- */
function routeGame(id){
  switch(id){
    case 'math': renderMath(); break;
    case 'spelling': renderSpelling(); break;
    case 'science': renderScience(); break;
    case 'social': renderSocial(); break;
    case 'memory': renderMemory(); break;
    case 'fasttap': renderFastTap(); break;
    case 'truefalse': renderTrueFalse(); break;
    case 'hangman': renderHangman(); break;
    default: showHome();
  }
}

function showHome(){
  currentGameEl.textContent = 'Select a game';
  gameArea.innerHTML = `<div class="small">Choose a game from the left. Games adapt to grade. Your points persist locally.</div>`;
}

/* ---------- Init ---------- */
showHome();
renderGameList();
updateUI();

/* ---------- Expose reset for button earlier ---------- */
window.resetProgress = resetProgress;
</script>
</body>
</html>
